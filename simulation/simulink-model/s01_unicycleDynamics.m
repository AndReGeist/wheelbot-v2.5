function dz = s01_unicycleDynamics(t, z, T)
% FIrst-order ODE describing the velocity and acceleration of the unicycle robot
% Fetches parameters from config_FlywUni.m 

q1 = z(1); % Roll
q1_d = z(2);
q2 = z(3); % Pitch
q2_d = z(4);
q3 = z(5); % Yaw
q3_d = z(6);
%q4 = z(7); % Wheel angle
q4_d = z(8);
%q5 = z(9); % Flywheel angle
q5_d = z(10);

Tw = T(1); % wheel motor torque
Tp = T(2); % flywheel motor torque

run(which('./s00_config.m'))
%{
M = [                                                                                                                         Icz + Ipy + Iwx + Lp^2*Mp + Mc*Rw^2 + Mp*Rw^2 + Mw*Rw^2 + Icx*cos(q2)^2 - Icz*cos(q2)^2 + Ipx*cos(q2)^2 - Ipy*cos(q2)^2 - Ipy*cos(q5)^2 + Ipz*cos(q5)^2 + Ipy*cos(q2)^2*cos(q5)^2 - Ipz*cos(q2)^2*cos(q5)^2 + Lc^2*Mc*cos(q2)^2 + Lc^2*Mp*cos(q2)^2 + Lcp^2*Mp*cos(q2)^2 - Lp^2*Mp*cos(q5)^2 + 2*Lc*Mc*Rw*cos(q2) + 2*Lc*Mp*Rw*cos(q2) + 2*Lcp*Mp*Rw*cos(q2) + 2*Lc*Lcp*Mp*cos(q2)^2 + Lp^2*Mp*cos(q2)^2*cos(q5)^2 + 2*Lc*Lp*Mp*cos(q2)^2*cos(q5) + 2*Lcp*Lp*Mp*cos(q2)^2*cos(q5) + 2*Lp*Mp*Rw*cos(q2)*cos(q5),                                                                                                                                                                                                                                                                                                                                                                                                              Ipy*cos(q5)*sin(q2)*sin(q5) - Ipz*cos(q5)*sin(q2)*sin(q5) + Lc*Lp*Mp*sin(q2)*sin(q5) + Lcp*Lp*Mp*sin(q2)*sin(q5) + Lp^2*Mp*cos(q5)*sin(q2)*sin(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Icz*cos(q1)*cos(q2)*sin(q2) - Icx*cos(q1)*cos(q2)*sin(q2) - Ipx*cos(q1)*cos(q2)*sin(q2) + Ipy*cos(q1)*cos(q2)*sin(q2) - Lc*Mc*Rw*cos(q1)*sin(q2) - Lc*Mp*Rw*cos(q1)*sin(q2) - Lcp*Mp*Rw*cos(q1)*sin(q2) + Ipy*cos(q5)*sin(q1)*sin(q2)*sin(q5) - Ipz*cos(q5)*sin(q1)*sin(q2)*sin(q5) - Ipy*cos(q1)*cos(q2)*cos(q5)^2*sin(q2) + Ipz*cos(q1)*cos(q2)*cos(q5)^2*sin(q2) - Lc^2*Mc*cos(q1)*cos(q2)*sin(q2) - Lc^2*Mp*cos(q1)*cos(q2)*sin(q2) - Lcp^2*Mp*cos(q1)*cos(q2)*sin(q2) - Lp^2*Mp*cos(q1)*cos(q2)*cos(q5)^2*sin(q2) - 2*Lc*Lcp*Mp*cos(q1)*cos(q2)*sin(q2) - Lp*Mp*Rw*cos(q1)*cos(q5)*sin(q2) + Lp^2*Mp*cos(q5)*sin(q1)*sin(q2)*sin(q5) + Lc*Lp*Mp*sin(q1)*sin(q2)*sin(q5) + Lcp*Lp*Mp*sin(q1)*sin(q2)*sin(q5) - 2*Lc*Lp*Mp*cos(q1)*cos(q2)*cos(q5)*sin(q2) - 2*Lcp*Lp*Mp*cos(q1)*cos(q2)*cos(q5)*sin(q2),                                                                                                                                                                                                                 0,                                                   Ipx*cos(q2) + Lp^2*Mp*cos(q2) + Lp*Mp*Rw*cos(q5) + Lc*Lp*Mp*cos(q2)*cos(q5) + Lcp*Lp*Mp*cos(q2)*cos(q5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sin(q2)*sin(q5)*(Ipy*cos(q5) - Ipz*cos(q5) + Lp^2*Mp*cos(q5) + Lc*Lp*Mp + Lcp*Lp*Mp),                                                                                                                                                                                                                                                                                                                                                                                                           Icy + Ipz + Lc^2*Mc + Lc^2*Mp + Lcp^2*Mp + Ipy*cos(q5)^2 - Ipz*cos(q5)^2 + 2*Lc*Lcp*Mp + Lp^2*Mp*cos(q5)^2 + 2*Lc*Lp*Mp*cos(q5) + 2*Lcp*Lp*Mp*cos(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Icy*sin(q1) + Ipz*sin(q1) + Lc^2*Mc*sin(q1) + Lc^2*Mp*sin(q1) + Lcp^2*Mp*sin(q1) + Ipy*cos(q5)^2*sin(q1) - Ipz*cos(q5)^2*sin(q1) + 2*Lc*Lcp*Mp*sin(q1) + Lp^2*Mp*cos(q5)^2*sin(q1) + Lc*Mc*Rw*cos(q2)*sin(q1) + Lc*Mp*Rw*cos(q2)*sin(q1) + Lcp*Mp*Rw*cos(q2)*sin(q1) + Ipy*cos(q1)*cos(q2)*cos(q5)*sin(q5) - Ipz*cos(q1)*cos(q2)*cos(q5)*sin(q5) + 2*Lc*Lp*Mp*cos(q5)*sin(q1) + 2*Lcp*Lp*Mp*cos(q5)*sin(q1) + Lp^2*Mp*cos(q1)*cos(q2)*cos(q5)*sin(q5) + Lc*Lp*Mp*cos(q1)*cos(q2)*sin(q5) + Lcp*Lp*Mp*cos(q1)*cos(q2)*sin(q5) + Lp*Mp*Rw*cos(q2)*cos(q5)*sin(q1),                                                                                                                                Lc*Mc*Rw*cos(q2) + Lc*Mp*Rw*cos(q2) + Lcp*Mp*Rw*cos(q2) + Lp*Mp*Rw*cos(q2)*cos(q5),                                                                                                                                                         0;
 -sin(q2)*(Icx*cos(q1)*cos(q2) - Icz*cos(q1)*cos(q2) + Ipx*cos(q1)*cos(q2) - Ipy*cos(q1)*cos(q2) + Lc^2*Mc*cos(q1)*cos(q2) + Lc^2*Mp*cos(q1)*cos(q2) + Lcp^2*Mp*cos(q1)*cos(q2) + Lc*Mc*Rw*cos(q1) + Lc*Mp*Rw*cos(q1) + Lcp*Mp*Rw*cos(q1) - Ipy*cos(q5)*sin(q1)*sin(q5) + Ipz*cos(q5)*sin(q1)*sin(q5) + Ipy*cos(q1)*cos(q2)*cos(q5)^2 - Ipz*cos(q1)*cos(q2)*cos(q5)^2 - Lc*Lp*Mp*sin(q1)*sin(q5) - Lcp*Lp*Mp*sin(q1)*sin(q5) + Lp^2*Mp*cos(q1)*cos(q2)*cos(q5)^2 + 2*Lc*Lcp*Mp*cos(q1)*cos(q2) + Lp*Mp*Rw*cos(q1)*cos(q5) - Lp^2*Mp*cos(q5)*sin(q1)*sin(q5) + 2*Lc*Lp*Mp*cos(q1)*cos(q2)*cos(q5) + 2*Lcp*Lp*Mp*cos(q1)*cos(q2)*cos(q5)), Icy*sin(q1) + Ipz*sin(q1) + Lc^2*Mc*sin(q1) + Lc^2*Mp*sin(q1) + Lcp^2*Mp*sin(q1) + Ipy*cos(q5)^2*sin(q1) - Ipz*cos(q5)^2*sin(q1) + 2*Lc*Lcp*Mp*sin(q1) + Lp^2*Mp*cos(q5)^2*sin(q1) + Lc*Mc*Rw*cos(q2)*sin(q1) + Lc*Mp*Rw*cos(q2)*sin(q1) + Lcp*Mp*Rw*cos(q2)*sin(q1) + Ipy*cos(q1)*cos(q2)*cos(q5)*sin(q5) - Ipz*cos(q1)*cos(q2)*cos(q5)*sin(q5) + 2*Lc*Lp*Mp*cos(q5)*sin(q1) + 2*Lcp*Lp*Mp*cos(q5)*sin(q1) + Lp^2*Mp*cos(q1)*cos(q2)*cos(q5)*sin(q5) + Lc*Lp*Mp*cos(q1)*cos(q2)*sin(q5) + Lcp*Lp*Mp*cos(q1)*cos(q2)*sin(q5) + Lp*Mp*Rw*cos(q2)*cos(q5)*sin(q1), Icy + Ipz + Iwy + Lc^2*Mc + Lc^2*Mp + Lcp^2*Mp + Mc*Rw^2 + Mp*Rw^2 + Mw*Rw^2 + Icx*cos(q1)^2 - Icy*cos(q1)^2 + Ipx*cos(q1)^2 + Ipy*cos(q5)^2 - Ipz*cos(q1)^2 - Ipz*cos(q5)^2 - Iwy*cos(q1)^2 + Iwz*cos(q1)^2 - Icx*cos(q1)^2*cos(q2)^2 + Icz*cos(q1)^2*cos(q2)^2 - Ipx*cos(q1)^2*cos(q2)^2 + Ipy*cos(q1)^2*cos(q2)^2 - Ipy*cos(q1)^2*cos(q5)^2 + Ipz*cos(q1)^2*cos(q5)^2 + 2*Lc*Lcp*Mp + Lp^2*Mp*cos(q1)^2 + Lp^2*Mp*cos(q5)^2 - Mc*Rw^2*cos(q1)^2 - Mp*Rw^2*cos(q1)^2 - Mw*Rw^2*cos(q1)^2 + 2*Lc*Lp*Mp*cos(q5) + 2*Lcp*Lp*Mp*cos(q5) + 2*Lc*Mc*Rw*cos(q2) + 2*Lc*Mp*Rw*cos(q2) + 2*Lcp*Mp*Rw*cos(q2) - Ipy*cos(q1)^2*cos(q2)^2*cos(q5)^2 + Ipz*cos(q1)^2*cos(q2)^2*cos(q5)^2 - Lc^2*Mc*cos(q1)^2*cos(q2)^2 - Lc^2*Mp*cos(q1)^2*cos(q2)^2 - Lcp^2*Mp*cos(q1)^2*cos(q2)^2 - Lp^2*Mp*cos(q1)^2*cos(q5)^2 - 2*Lc*Mc*Rw*cos(q1)^2*cos(q2) - 2*Lc*Mp*Rw*cos(q1)^2*cos(q2) - 2*Lcp*Mp*Rw*cos(q1)^2*cos(q2) - 2*Lc*Lcp*Mp*cos(q1)^2*cos(q2)^2 - Lp^2*Mp*cos(q1)^2*cos(q2)^2*cos(q5)^2 + 2*Lp*Mp*Rw*cos(q2)*cos(q5) - 2*Lp*Mp*Rw*cos(q1)^2*cos(q2)*cos(q5) - 2*Lc*Lp*Mp*cos(q1)^2*cos(q2)^2*cos(q5) - 2*Lcp*Lp*Mp*cos(q1)^2*cos(q2)^2*cos(q5) + 2*Lp*Mp*Rw*cos(q1)*sin(q1)*sin(q5) + 2*Ipy*cos(q1)*cos(q2)*cos(q5)*sin(q1)*sin(q5) - 2*Ipz*cos(q1)*cos(q2)*cos(q5)*sin(q1)*sin(q5) + 2*Lp^2*Mp*cos(q1)*cos(q2)*cos(q5)*sin(q1)*sin(q5) + 2*Lc*Lp*Mp*cos(q1)*cos(q2)*sin(q1)*sin(q5) + 2*Lcp*Lp*Mp*cos(q1)*cos(q2)*sin(q1)*sin(q5), Iwy*sin(q1) + Mc*Rw^2*sin(q1) + Mp*Rw^2*sin(q1) + Mw*Rw^2*sin(q1) + Lc*Mc*Rw*cos(q2)*sin(q1) + Lc*Mp*Rw*cos(q2)*sin(q1) + Lcp*Mp*Rw*cos(q2)*sin(q1) + Lp*Mp*Rw*cos(q1)*sin(q5) + Lp*Mp*Rw*cos(q2)*cos(q5)*sin(q1), - Ipx*cos(q1)*sin(q2) - Lp^2*Mp*cos(q1)*sin(q2) - Lc*Lp*Mp*cos(q1)*cos(q5)*sin(q2) - Lcp*Lp*Mp*cos(q1)*cos(q5)*sin(q2) - Lp*Mp*Rw*sin(q1)*sin(q2)*sin(q5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Lc*Mc*Rw*cos(q2) + Lc*Mp*Rw*cos(q2) + Lcp*Mp*Rw*cos(q2) + Lp*Mp*Rw*cos(q2)*cos(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Iwy*sin(q1) + Mc*Rw^2*sin(q1) + Mp*Rw^2*sin(q1) + Mw*Rw^2*sin(q1) + Lc*Mc*Rw*cos(q2)*sin(q1) + Lc*Mp*Rw*cos(q2)*sin(q1) + Lcp*Mp*Rw*cos(q2)*sin(q1) + Lp*Mp*Rw*cos(q1)*sin(q5) + Lp*Mp*Rw*cos(q2)*cos(q5)*sin(q1),                                                                                                                                                                                 Iwy + Mc*Rw^2 + Mp*Rw^2 + Mw*Rw^2,                                                                                                                                 -Lp*Mp*Rw*sin(q2)*sin(q5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Ipx*cos(q2) + Lp^2*Mp*cos(q2) + Lp*Mp*Rw*cos(q5) + Lc*Lp*Mp*cos(q2)*cos(q5) + Lcp*Lp*Mp*cos(q2)*cos(q5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 - Ipx*cos(q1)*sin(q2) - Lp^2*Mp*cos(q1)*sin(q2) - Lc*Lp*Mp*cos(q1)*cos(q5)*sin(q2) - Lcp*Lp*Mp*cos(q1)*cos(q5)*sin(q2) - Lp*Mp*Rw*sin(q1)*sin(q2)*sin(q5),                                                                                                                                                                                         -Lp*Mp*Rw*sin(q2)*sin(q5),                                                                                                                                             Mp*Lp^2 + Ipx];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
RHS = [(Icy*q3_d^2*sin(2*q1))/2 - (Icx*q3_d^2*sin(2*q1))/2 - (Ipx*q3_d^2*sin(2*q1))/2 + (Ipz*q3_d^2*sin(2*q1))/2 + (Iwy*q3_d^2*sin(2*q1))/2 - (Iwz*q3_d^2*sin(2*q1))/2 + Mc*Rw*g*sin(q1) + Mp*Rw*g*sin(q1) + Mw*Rw*g*sin(q1) - Icx*q2_d*q3_d*cos(q1) + Icy*q2_d*q3_d*cos(q1) + Icz*q2_d*q3_d*cos(q1) - Ipx*q2_d*q3_d*cos(q1) + Ipy*q2_d*q3_d*cos(q1) + Ipz*q2_d*q3_d*cos(q1) + Iwy*q3_d*q4_d*cos(q1) - (Lp^2*Mp*q3_d^2*sin(2*q1))/2 + Ipx*q2_d*q5_d*sin(q2) + Ipy*q2_d*q5_d*sin(q2) - Ipz*q2_d*q5_d*sin(q2) + (Mc*Rw^2*q3_d^2*sin(2*q1))/2 + (Mp*Rw^2*q3_d^2*sin(2*q1))/2 + (Mw*Rw^2*q3_d^2*sin(2*q1))/2 + Icx*q1_d*q2_d*sin(2*q2) - Icz*q1_d*q2_d*sin(2*q2) + Ipx*q1_d*q2_d*sin(2*q2) - Ipy*q1_d*q2_d*sin(2*q2) - Ipy*q1_d*q5_d*sin(2*q5) + Ipz*q1_d*q5_d*sin(2*q5) - Lp*Mp*Rw*q3_d^2*sin(q5) + Lp*Mp*Rw*q5_d^2*sin(q5) - Ipy*q2_d^2*cos(q2)*cos(q5)*sin(q5) - Ipy*q3_d^2*cos(q2)*cos(q5)*sin(q5) + Ipz*q2_d^2*cos(q2)*cos(q5)*sin(q5) + Ipz*q3_d^2*cos(q2)*cos(q5)*sin(q5) + Mc*Rw^2*q3_d*q4_d*cos(q1) + Mp*Rw^2*q3_d*q4_d*cos(q1) + Mw*Rw^2*q3_d*q4_d*cos(q1) + Lc*Mc*g*cos(q2)*sin(q1) + Lc*Mp*g*cos(q2)*sin(q1) + Lcp*Mp*g*cos(q2)*sin(q1) + Lp*Mp*g*cos(q1)*sin(q5) + 2*Lp^2*Mp*q2_d*q5_d*sin(q2) + Ipx*q3_d*q5_d*sin(q1)*sin(q2) + Ipy*q3_d*q5_d*sin(q1)*sin(q2) - Ipz*q3_d*q5_d*sin(q1)*sin(q2) + Icx*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) - Icz*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) + Ipx*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) - Ipy*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) + Ipy*q3_d^2*cos(q1)*cos(q5)^2*sin(q1) - Ipz*q3_d^2*cos(q1)*cos(q5)^2*sin(q1) + Lc^2*Mc*q1_d*q2_d*sin(2*q2) + Lc^2*Mp*q1_d*q2_d*sin(2*q2) + Lcp^2*Mp*q1_d*q2_d*sin(2*q2) - Lp^2*Mp*q1_d*q5_d*sin(2*q5) + 2*Icx*q2_d*q3_d*cos(q1)*cos(q2)^2 - 2*Icz*q2_d*q3_d*cos(q1)*cos(q2)^2 + 2*Ipx*q2_d*q3_d*cos(q1)*cos(q2)^2 - 2*Ipy*q2_d*q3_d*cos(q1)*cos(q2)^2 - 2*Ipy*q2_d*q5_d*cos(q5)^2*sin(q2) + 2*Ipz*q2_d*q5_d*cos(q5)^2*sin(q2) + 2*Lp^2*Mp*q3_d*q5_d*sin(q1)*sin(q2) + 2*Lc*Mc*Rw*q1_d*q2_d*sin(q2) + 2*Lc*Mp*Rw*q1_d*q2_d*sin(q2) + 2*Lcp*Mp*Rw*q1_d*q2_d*sin(q2) + Lc^2*Mc*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) + Lc^2*Mp*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) + Lcp^2*Mp*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) + Lp^2*Mp*q3_d^2*cos(q1)*cos(q5)^2*sin(q1) + 2*Lp*Mp*Rw*q3_d^2*cos(q1)^2*sin(q5) + 2*Ipy*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)*sin(q5) - 2*Ipz*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)*sin(q5) + 2*Lc^2*Mc*q2_d*q3_d*cos(q1)*cos(q2)^2 + 2*Lc^2*Mp*q2_d*q3_d*cos(q1)*cos(q2)^2 + 2*Lcp^2*Mp*q2_d*q3_d*cos(q1)*cos(q2)^2 - 2*Lp^2*Mp*q2_d*q5_d*cos(q5)^2*sin(q2) + 2*Lc*Lcp*Mp*q1_d*q2_d*sin(2*q2) + 2*Ipy*q1_d*q2_d*cos(q2)*cos(q5)^2*sin(q2) + 2*Ipy*q1_d*q5_d*cos(q2)^2*cos(q5)*sin(q5) - 2*Ipz*q1_d*q2_d*cos(q2)*cos(q5)^2*sin(q2) - 2*Ipz*q1_d*q5_d*cos(q2)^2*cos(q5)*sin(q5) - 2*Ipy*q3_d*q5_d*cos(q5)^2*sin(q1)*sin(q2) + 2*Ipz*q3_d*q5_d*cos(q5)^2*sin(q1)*sin(q2) + Ipy*q3_d^2*cos(q1)*cos(q2)^2*cos(q5)^2*sin(q1) - Ipz*q3_d^2*cos(q1)*cos(q2)^2*cos(q5)^2*sin(q1) - Lp^2*Mp*q2_d^2*cos(q2)*cos(q5)*sin(q5) - Lp^2*Mp*q3_d^2*cos(q2)*cos(q5)*sin(q5) + 2*Ipy*q2_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2 - 2*Ipz*q2_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2 - Lc*Lp*Mp*q2_d^2*cos(q2)*sin(q5) - Lc*Lp*Mp*q3_d^2*cos(q2)*sin(q5) + Lc*Lp*Mp*q5_d^2*cos(q2)*sin(q5) - Lcp*Lp*Mp*q2_d^2*cos(q2)*sin(q5) - Lcp*Lp*Mp*q3_d^2*cos(q2)*sin(q5) + Lcp*Lp*Mp*q5_d^2*cos(q2)*sin(q5) + Lp*Mp*g*cos(q2)*cos(q5)*sin(q1) + 2*Lc*Lcp*Mp*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) + 2*Lc*Lp*Mp*q3_d^2*cos(q1)^2*cos(q2)*sin(q5) + 2*Lcp*Lp*Mp*q3_d^2*cos(q1)^2*cos(q2)*sin(q5) + 2*Lp^2*Mp*q1_d*q2_d*cos(q2)*cos(q5)^2*sin(q2) + 2*Lp^2*Mp*q1_d*q5_d*cos(q2)^2*cos(q5)*sin(q5) + 4*Lc*Lcp*Mp*q2_d*q3_d*cos(q1)*cos(q2)^2 - 2*Lp^2*Mp*q3_d*q5_d*cos(q5)^2*sin(q1)*sin(q2) + 2*Lc*Lp*Mp*q1_d*q5_d*cos(q2)^2*sin(q5) + 2*Lcp*Lp*Mp*q1_d*q5_d*cos(q2)^2*sin(q5) + Lp^2*Mp*q3_d^2*cos(q1)*cos(q2)^2*cos(q5)^2*sin(q1) + 2*Lp^2*Mp*q2_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2 + 2*Lc*Mc*Rw*q3_d^2*cos(q1)*cos(q2)*sin(q1) + 2*Lc*Mp*Rw*q3_d^2*cos(q1)*cos(q2)*sin(q1) + 2*Lcp*Mp*Rw*q3_d^2*cos(q1)*cos(q2)*sin(q1) + 2*Lc*Mc*Rw*q2_d*q3_d*cos(q1)*cos(q2) + Lc*Mc*Rw*q3_d*q4_d*cos(q1)*cos(q2) + 2*Lc*Mp*Rw*q2_d*q3_d*cos(q1)*cos(q2) + Lc*Mp*Rw*q3_d*q4_d*cos(q1)*cos(q2) + 2*Lcp*Mp*Rw*q2_d*q3_d*cos(q1)*cos(q2) + Lcp*Mp*Rw*q3_d*q4_d*cos(q1)*cos(q2) + 2*Lp*Mp*Rw*q1_d*q2_d*cos(q5)*sin(q2) + 2*Lp*Mp*Rw*q1_d*q5_d*cos(q2)*sin(q5) + 2*Lp^2*Mp*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)*sin(q5) - Lp*Mp*Rw*q3_d*q4_d*sin(q1)*sin(q5) - 2*Ipy*q2_d*q3_d*cos(q2)*cos(q5)*sin(q1)*sin(q5) + 2*Ipz*q2_d*q3_d*cos(q2)*cos(q5)*sin(q1)*sin(q5) + 4*Lc*Lp*Mp*q2_d*q3_d*cos(q1)*cos(q2)^2*cos(q5) + 4*Lcp*Lp*Mp*q2_d*q3_d*cos(q1)*cos(q2)^2*cos(q5) + 2*Lp*Mp*Rw*q3_d^2*cos(q1)*cos(q2)*cos(q5)*sin(q1) + 2*Lp*Mp*Rw*q2_d*q3_d*cos(q1)*cos(q2)*cos(q5) + Lp*Mp*Rw*q3_d*q4_d*cos(q1)*cos(q2)*cos(q5) - 2*Lp^2*Mp*q2_d*q3_d*cos(q2)*cos(q5)*sin(q1)*sin(q5) + 4*Lc*Lp*Mp*q1_d*q2_d*cos(q2)*cos(q5)*sin(q2) + 4*Lcp*Lp*Mp*q1_d*q2_d*cos(q2)*cos(q5)*sin(q2) - 2*Lc*Lp*Mp*q2_d*q3_d*cos(q2)*sin(q1)*sin(q5) - 2*Lcp*Lp*Mp*q2_d*q3_d*cos(q2)*sin(q1)*sin(q5) - 2*Lp*Mp*Rw*q3_d*q5_d*cos(q1)*sin(q2)*sin(q5) - 2*Ipy*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 2*Ipz*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 2*Lc*Lp*Mp*q3_d^2*cos(q1)*cos(q2)^2*cos(q5)*sin(q1) + 2*Lcp*Lp*Mp*q3_d^2*cos(q1)*cos(q2)^2*cos(q5)*sin(q1) - 2*Lp^2*Mp*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) - 2*Lc*Lp*Mp*q3_d*q5_d*cos(q1)*cos(q2)*sin(q2)*sin(q5) - 2*Lcp*Lp*Mp*q3_d*q5_d*cos(q1)*cos(q2)*sin(q2)*sin(q5);     
            (Icz*q1_d^2*sin(2*q2))/2 - (Icx*q1_d^2*sin(2*q2))/2 - Tw - (Ipx*q1_d^2*sin(2*q2))/2 + (Ipy*q1_d^2*sin(2*q2))/2 + Icx*q1_d*q3_d*cos(q1) - Icy*q1_d*q3_d*cos(q1) - Icz*q1_d*q3_d*cos(q1) + Ipx*q1_d*q3_d*cos(q1) - Ipy*q1_d*q3_d*cos(q1) - Ipz*q1_d*q3_d*cos(q1) - (Lc^2*Mc*q1_d^2*sin(2*q2))/2 - (Lc^2*Mp*q1_d^2*sin(2*q2))/2 - (Lcp^2*Mp*q1_d^2*sin(2*q2))/2 - Ipx*q1_d*q5_d*sin(q2) + Ipy*q1_d*q5_d*sin(q2) - Ipz*q1_d*q5_d*sin(q2) + Ipy*q2_d*q5_d*sin(2*q5) - Ipz*q2_d*q5_d*sin(2*q5) - Lc*Mc*Rw*q1_d^2*sin(q2) - Lc*Mc*Rw*q3_d^2*sin(q2) - Lc*Mp*Rw*q1_d^2*sin(q2) - Lc*Mp*Rw*q3_d^2*sin(q2) - Lcp*Mp*Rw*q1_d^2*sin(q2) - Lcp*Mp*Rw*q3_d^2*sin(q2) + Lc*Mc*g*cos(q1)*sin(q2) + Lc*Mp*g*cos(q1)*sin(q2) + Lcp*Mp*g*cos(q1)*sin(q2) - Ipx*q3_d*q5_d*cos(q1)*cos(q2) + Ipy*q3_d*q5_d*cos(q1)*cos(q2) - Ipz*q3_d*q5_d*cos(q1)*cos(q2) - Lc*Lcp*Mp*q1_d^2*sin(2*q2) + Icx*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) - Icz*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) + Ipx*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) - Ipy*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) - Ipy*q1_d^2*cos(q2)*cos(q5)^2*sin(q2) + Ipz*q1_d^2*cos(q2)*cos(q5)^2*sin(q2) + Lp^2*Mp*q2_d*q5_d*sin(2*q5) - 2*Icx*q1_d*q3_d*cos(q1)*cos(q2)^2 + 2*Icz*q1_d*q3_d*cos(q1)*cos(q2)^2 - 2*Ipx*q1_d*q3_d*cos(q1)*cos(q2)^2 + 2*Ipy*q1_d*q3_d*cos(q1)*cos(q2)^2 - 2*Ipy*q1_d*q5_d*cos(q5)^2*sin(q2) + 2*Ipz*q1_d*q5_d*cos(q5)^2*sin(q2) + 2*Lc*Lp*Mp*q2_d*q5_d*sin(q5) + 2*Lcp*Lp*Mp*q2_d*q5_d*sin(q5) + Lc^2*Mc*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) + Lc^2*Mp*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) + Lcp^2*Mp*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) - Lp^2*Mp*q1_d^2*cos(q2)*cos(q5)^2*sin(q2) + 2*Ipy*q3_d*q5_d*cos(q5)*sin(q1)*sin(q5) - 2*Ipz*q3_d*q5_d*cos(q5)*sin(q1)*sin(q5) + Lc*Mc*Rw*q3_d^2*cos(q1)^2*sin(q2) + Lc*Mp*Rw*q3_d^2*cos(q1)^2*sin(q2) + Lcp*Mp*Rw*q3_d^2*cos(q1)^2*sin(q2) - 2*Lc^2*Mc*q1_d*q3_d*cos(q1)*cos(q2)^2 - 2*Lc^2*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2 - 2*Lcp^2*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2 - 2*Lp^2*Mp*q1_d*q5_d*cos(q5)^2*sin(q2) - 2*Ipy*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2 + 2*Ipz*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2 + Ipy*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)^2*sin(q2) - Ipz*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)^2*sin(q2) - 2*Ipy*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2 + 2*Ipz*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2 - Lp*Mp*Rw*q1_d^2*cos(q5)*sin(q2) - Lp*Mp*Rw*q3_d^2*cos(q5)*sin(q2) + Lp*Mp*g*cos(q1)*cos(q5)*sin(q2) + 2*Lc*Lcp*Mp*q3_d^2*cos(q1)^2*cos(q2)*sin(q2) + Lp*Mp*Rw*q3_d^2*cos(q1)^2*cos(q5)*sin(q2) - 2*Lp^2*Mp*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2 - 4*Lc*Lcp*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2 + Lp^2*Mp*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)^2*sin(q2) - 2*Lp^2*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2 - 2*Lc*Lp*Mp*q1_d^2*cos(q2)*cos(q5)*sin(q2) - 2*Lcp*Lp*Mp*q1_d^2*cos(q2)*cos(q5)*sin(q2) - Ipy*q3_d^2*cos(q1)*cos(q5)*sin(q1)*sin(q2)*sin(q5) + Ipz*q3_d^2*cos(q1)*cos(q5)*sin(q1)*sin(q2)*sin(q5) - 2*Lc*Mc*Rw*q1_d*q3_d*cos(q1)*cos(q2) - 2*Lc*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2) - 2*Lcp*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2) + 2*Lp^2*Mp*q3_d*q5_d*cos(q5)*sin(q1)*sin(q5) - 2*Lc*Lp*Mp*q1_d*q5_d*cos(q5)*sin(q2) - 2*Lcp*Lp*Mp*q1_d*q5_d*cos(q5)*sin(q2) + 2*Lc*Lp*Mp*q3_d*q5_d*sin(q1)*sin(q5) + 2*Lcp*Lp*Mp*q3_d*q5_d*sin(q1)*sin(q5) - Lc*Mc*Rw*q3_d*q4_d*sin(q1)*sin(q2) - Lc*Mp*Rw*q3_d*q4_d*sin(q1)*sin(q2) - Lcp*Mp*Rw*q3_d*q4_d*sin(q1)*sin(q2) + 2*Ipy*q1_d*q3_d*cos(q2)*cos(q5)*sin(q1)*sin(q5) - 2*Ipz*q1_d*q3_d*cos(q2)*cos(q5)*sin(q1)*sin(q5) - 4*Lc*Lp*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5) - 4*Lcp*Lp*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5) - Lp^2*Mp*q3_d^2*cos(q1)*cos(q5)*sin(q1)*sin(q2)*sin(q5) - Lc*Lp*Mp*q3_d^2*cos(q1)*sin(q1)*sin(q2)*sin(q5) - Lcp*Lp*Mp*q3_d^2*cos(q1)*sin(q1)*sin(q2)*sin(q5) - 2*Lc*Lp*Mp*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5) - 2*Lcp*Lp*Mp*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5) - 2*Lp*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2)*cos(q5) + 2*Lp^2*Mp*q1_d*q3_d*cos(q2)*cos(q5)*sin(q1)*sin(q5) + 2*Lc*Lp*Mp*q1_d*q3_d*cos(q2)*sin(q1)*sin(q5) + 2*Lcp*Lp*Mp*q1_d*q3_d*cos(q2)*sin(q1)*sin(q5) - Lp*Mp*Rw*q3_d*q4_d*cos(q5)*sin(q1)*sin(q2) + 2*Lc*Lp*Mp*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)*sin(q2) + 2*Lcp*Lp*Mp*q3_d^2*cos(q1)^2*cos(q2)*cos(q5)*sin(q2);      
            Icz*q1_d*q2_d*cos(q1) - Icy*q1_d*q2_d*cos(q1) - Icx*q1_d*q2_d*cos(q1) - Ipx*q1_d*q2_d*cos(q1) + Ipy*q1_d*q2_d*cos(q1) - Ipz*q1_d*q2_d*cos(q1) - Iwy*q1_d*q4_d*cos(q1) + Icx*q1_d*q3_d*sin(2*q1) - Icy*q1_d*q3_d*sin(2*q1) + Ipx*q1_d*q3_d*sin(2*q1) + Ipy*q3_d*q5_d*sin(2*q5) - Ipz*q1_d*q3_d*sin(2*q1) - Ipz*q3_d*q5_d*sin(2*q5) - Iwy*q1_d*q3_d*sin(2*q1) + Iwz*q1_d*q3_d*sin(2*q1) - 2*Lc^2*Mc*q1_d*q2_d*cos(q1) - 2*Lc^2*Mp*q1_d*q2_d*cos(q1) - 2*Lcp^2*Mp*q1_d*q2_d*cos(q1) - Icx*q1_d^2*cos(q2)*sin(q1)*sin(q2) + Icz*q1_d^2*cos(q2)*sin(q1)*sin(q2) - Ipx*q1_d^2*cos(q2)*sin(q1)*sin(q2) + Ipy*q1_d^2*cos(q2)*sin(q1)*sin(q2) + Ipx*q2_d*q5_d*cos(q1)*cos(q2) + Ipy*q2_d*q5_d*cos(q1)*cos(q2) - Ipz*q2_d*q5_d*cos(q1)*cos(q2) - Ipx*q1_d*q5_d*sin(q1)*sin(q2) + Ipy*q1_d*q5_d*sin(q1)*sin(q2) - Ipz*q1_d*q5_d*sin(q1)*sin(q2) + Lp^2*Mp*q1_d*q3_d*sin(2*q1) + Lp^2*Mp*q3_d*q5_d*sin(2*q5) - Mc*Rw^2*q1_d*q3_d*sin(2*q1) - Mp*Rw^2*q1_d*q3_d*sin(2*q1) - Mw*Rw^2*q1_d*q3_d*sin(2*q1) + 2*Icx*q1_d*q2_d*cos(q1)*cos(q2)^2 - 2*Icz*q1_d*q2_d*cos(q1)*cos(q2)^2 + 2*Ipx*q1_d*q2_d*cos(q1)*cos(q2)^2 - 2*Ipy*q1_d*q2_d*cos(q1)*cos(q2)^2 - 2*Ipy*q1_d*q2_d*cos(q1)*cos(q5)^2 + 2*Ipz*q1_d*q2_d*cos(q1)*cos(q5)^2 + 2*Lc*Lp*Mp*q3_d*q5_d*sin(q5) + 2*Lcp*Lp*Mp*q3_d*q5_d*sin(q5) + 2*Lc*Mc*Rw*q2_d*q3_d*sin(q2) - Lc*Mc*Rw*q3_d*q4_d*sin(q2) + 2*Lc*Mp*Rw*q2_d*q3_d*sin(q2) - Lc*Mp*Rw*q3_d*q4_d*sin(q2) + 2*Lcp*Mp*Rw*q2_d*q3_d*sin(q2) - Lcp*Mp*Rw*q3_d*q4_d*sin(q2) + 2*Lp*Mp*Rw*q1_d*q3_d*sin(q5) + 2*Ipy*q3_d*q5_d*cos(q1)*cos(q2)*sin(q1) + 2*Ipy*q1_d*q3_d*cos(q2)*cos(q5)*sin(q5) - 2*Ipz*q3_d*q5_d*cos(q1)*cos(q2)*sin(q1) - 2*Ipz*q1_d*q3_d*cos(q2)*cos(q5)*sin(q5) + 2*Ipy*q2_d*q5_d*cos(q5)*sin(q1)*sin(q5) - 2*Ipz*q2_d*q5_d*cos(q5)*sin(q1)*sin(q5) + 2*Lc^2*Mc*q1_d*q2_d*cos(q1)*cos(q2)^2 + 2*Lc^2*Mp*q1_d*q2_d*cos(q1)*cos(q2)^2 + 2*Lcp^2*Mp*q1_d*q2_d*cos(q1)*cos(q2)^2 - 2*Lp^2*Mp*q1_d*q2_d*cos(q1)*cos(q5)^2 - Ipy*q1_d^2*cos(q2)*cos(q5)^2*sin(q1)*sin(q2) + Ipz*q1_d^2*cos(q2)*cos(q5)^2*sin(q1)*sin(q2) - 2*Ipy*q2_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2 + 2*Ipz*q2_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2 - 2*Icx*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) - 2*Icx*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) + 2*Icz*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) + 2*Icz*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) - 2*Ipx*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) - 2*Ipx*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) + 2*Ipy*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) + 2*Ipy*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) - 2*Ipy*q1_d*q3_d*cos(q1)*cos(q5)^2*sin(q1) - 2*Ipy*q3_d*q5_d*cos(q1)^2*cos(q5)*sin(q5) + 2*Ipz*q1_d*q3_d*cos(q1)*cos(q5)^2*sin(q1) + 2*Ipz*q3_d*q5_d*cos(q1)^2*cos(q5)*sin(q5) - 2*Ipy*q1_d*q5_d*cos(q5)^2*sin(q1)*sin(q2) + 2*Ipz*q1_d*q5_d*cos(q5)^2*sin(q1)*sin(q2) - Lc^2*Mc*q1_d^2*cos(q2)*sin(q1)*sin(q2) - Lc^2*Mp*q1_d^2*cos(q2)*sin(q1)*sin(q2) - Lcp^2*Mp*q1_d^2*cos(q2)*sin(q1)*sin(q2) + 2*Ipy*q1_d*q2_d*cos(q1)*cos(q2)^2*cos(q5)^2 - 2*Ipz*q1_d*q2_d*cos(q1)*cos(q2)^2*cos(q5)^2 + 2*Lp^2*Mp*q2_d*q5_d*cos(q1)*cos(q2) - Lc*Mc*Rw*q1_d^2*sin(q1)*sin(q2) + Lc*Mc*Rw*q2_d^2*sin(q1)*sin(q2) - Lc*Mp*Rw*q1_d^2*sin(q1)*sin(q2) + Lc*Mp*Rw*q2_d^2*sin(q1)*sin(q2) - Lcp*Mp*Rw*q1_d^2*sin(q1)*sin(q2) + Lcp*Mp*Rw*q2_d^2*sin(q1)*sin(q2) - Ipy*q1_d^2*cos(q1)*cos(q5)*sin(q2)*sin(q5) + Ipy*q2_d^2*cos(q1)*cos(q5)*sin(q2)*sin(q5) + Ipz*q1_d^2*cos(q1)*cos(q5)*sin(q2)*sin(q5) - Ipz*q2_d^2*cos(q1)*cos(q5)*sin(q2)*sin(q5) - 4*Lc*Lcp*Mp*q1_d*q2_d*cos(q1) - 2*Lp^2*Mp*q2_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2 - 2*Lc^2*Mc*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) - 2*Lc^2*Mc*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) - 2*Lc^2*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) - 2*Lc^2*Mp*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) - 2*Lcp^2*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) - 2*Lcp^2*Mp*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) - 2*Lp^2*Mp*q1_d*q3_d*cos(q1)*cos(q5)^2*sin(q1) - 2*Lp^2*Mp*q3_d*q5_d*cos(q1)^2*cos(q5)*sin(q5) + 4*Lc*Lcp*Mp*q1_d*q2_d*cos(q1)*cos(q2)^2 - 2*Lp^2*Mp*q1_d*q5_d*cos(q5)^2*sin(q1)*sin(q2) - 2*Lc*Mc*Rw*q2_d*q3_d*cos(q1)^2*sin(q2) - 2*Lc*Mp*Rw*q2_d*q3_d*cos(q1)^2*sin(q2) - 2*Lcp*Mp*Rw*q2_d*q3_d*cos(q1)^2*sin(q2) - 4*Lp*Mp*Rw*q1_d*q3_d*cos(q1)^2*sin(q5) - 4*Ipy*q1_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)*sin(q5) - 4*Ipy*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2*sin(q1) + 4*Ipz*q1_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)*sin(q5) + 4*Ipz*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2*sin(q1) + 2*Lp^2*Mp*q1_d*q2_d*cos(q1)*cos(q2)^2*cos(q5)^2 - Lp^2*Mp*q1_d^2*cos(q1)*cos(q5)*sin(q2)*sin(q5) + Lp^2*Mp*q2_d^2*cos(q1)*cos(q5)*sin(q2)*sin(q5) - 2*Ipy*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2*sin(q1) - 2*Ipy*q2_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)^2*sin(q2) - 2*Ipy*q3_d*q5_d*cos(q1)^2*cos(q2)^2*cos(q5)*sin(q5) + 2*Ipz*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2*sin(q1) + 2*Ipz*q2_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)^2*sin(q2) + 2*Ipz*q3_d*q5_d*cos(q1)^2*cos(q2)^2*cos(q5)*sin(q5) - 2*Lc*Lcp*Mp*q1_d^2*cos(q2)*sin(q1)*sin(q2) - Lc*Lp*Mp*q1_d^2*cos(q1)*sin(q2)*sin(q5) + Lc*Lp*Mp*q2_d^2*cos(q1)*sin(q2)*sin(q5) - Lc*Lp*Mp*q5_d^2*cos(q1)*sin(q2)*sin(q5) - Lcp*Lp*Mp*q1_d^2*cos(q1)*sin(q2)*sin(q5) + Lcp*Lp*Mp*q2_d^2*cos(q1)*sin(q2)*sin(q5) - Lcp*Lp*Mp*q5_d^2*cos(q1)*sin(q2)*sin(q5) - Lp*Mp*Rw*q1_d^2*cos(q5)*sin(q1)*sin(q2) + Lp*Mp*Rw*q2_d^2*cos(q5)*sin(q1)*sin(q2) + Lp*Mp*Rw*q5_d^2*cos(q5)*sin(q1)*sin(q2) + 2*Lp^2*Mp*q3_d*q5_d*cos(q1)*cos(q2)*sin(q1) + 2*Lp^2*Mp*q1_d*q3_d*cos(q2)*cos(q5)*sin(q5) - 4*Lc*Lp*Mp*q1_d*q2_d*cos(q1)*cos(q5) - 4*Lcp*Lp*Mp*q1_d*q2_d*cos(q1)*cos(q5) + 2*Lp^2*Mp*q2_d*q5_d*cos(q5)*sin(q1)*sin(q5) + 2*Lc*Lp*Mp*q1_d*q3_d*cos(q2)*sin(q5) + 2*Lcp*Lp*Mp*q1_d*q3_d*cos(q2)*sin(q5) + 2*Lp*Mp*Rw*q2_d*q3_d*cos(q5)*sin(q2) - Lp*Mp*Rw*q3_d*q4_d*cos(q5)*sin(q2) + 2*Lp*Mp*Rw*q3_d*q5_d*cos(q2)*sin(q5) + 2*Lc*Lp*Mp*q2_d*q5_d*sin(q1)*sin(q5) + 2*Lcp*Lp*Mp*q2_d*q5_d*sin(q1)*sin(q5) - Lp^2*Mp*q1_d^2*cos(q2)*cos(q5)^2*sin(q1)*sin(q2) + 4*Lc*Lp*Mp*q1_d*q2_d*cos(q1)*cos(q2)^2*cos(q5) + 4*Lcp*Lp*Mp*q1_d*q2_d*cos(q1)*cos(q2)^2*cos(q5) - 4*Lc*Lcp*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*sin(q1) - 4*Lc*Lcp*Mp*q2_d*q3_d*cos(q1)^2*cos(q2)*sin(q2) - 4*Lc*Lp*Mp*q1_d*q3_d*cos(q1)^2*cos(q2)*sin(q5) - 4*Lcp*Lp*Mp*q1_d*q3_d*cos(q1)^2*cos(q2)*sin(q5) - 2*Lp*Mp*Rw*q2_d*q3_d*cos(q1)^2*cos(q5)*sin(q2) - 2*Lp*Mp*Rw*q3_d*q5_d*cos(q1)^2*cos(q2)*sin(q5) - 2*Lp^2*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)^2*sin(q1) - 2*Lp^2*Mp*q2_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)^2*sin(q2) - 2*Lp^2*Mp*q3_d*q5_d*cos(q1)^2*cos(q2)^2*cos(q5)*sin(q5) - 2*Lc*Lp*Mp*q3_d*q5_d*cos(q1)^2*cos(q2)^2*sin(q5) - 2*Lcp*Lp*Mp*q3_d*q5_d*cos(q1)^2*cos(q2)^2*sin(q5) - 2*Lc*Lp*Mp*q1_d^2*cos(q2)*cos(q5)*sin(q1)*sin(q2) - 2*Lcp*Lp*Mp*q1_d^2*cos(q2)*cos(q5)*sin(q1)*sin(q2) - 4*Lc*Mc*Rw*q1_d*q3_d*cos(q1)*cos(q2)*sin(q1) - 4*Lc*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2)*sin(q1) - 4*Lcp*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2)*sin(q1) - 2*Lp*Mp*Rw*q3_d*q5_d*cos(q1)*cos(q5)*sin(q1) - 2*Lc*Lp*Mp*q1_d*q5_d*cos(q5)*sin(q1)*sin(q2) - 2*Lcp*Lp*Mp*q1_d*q5_d*cos(q5)*sin(q1)*sin(q2) + 2*Lp*Mp*Rw*q2_d*q5_d*cos(q2)*sin(q1)*sin(q5) - 2*Ipy*q1_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 2*Ipz*q1_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 2*Ipy*q2_d*q3_d*cos(q1)*cos(q5)*sin(q1)*sin(q2)*sin(q5) - 2*Ipz*q2_d*q3_d*cos(q1)*cos(q5)*sin(q1)*sin(q2)*sin(q5) - 4*Lp^2*Mp*q1_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)*sin(q5) - 4*Lp^2*Mp*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)^2*sin(q1) - 2*Lp^2*Mp*q1_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) - 2*Lc*Lp*Mp*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q1) - 2*Lcp*Lp*Mp*q3_d*q5_d*cos(q1)*cos(q2)*cos(q5)*sin(q1) - 4*Lp*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2)*cos(q5)*sin(q1) + 2*Lp^2*Mp*q2_d*q3_d*cos(q1)*cos(q5)*sin(q1)*sin(q2)*sin(q5) - 2*Lc*Lp*Mp*q1_d*q5_d*cos(q1)*cos(q2)*sin(q2)*sin(q5) - 2*Lcp*Lp*Mp*q1_d*q5_d*cos(q1)*cos(q2)*sin(q2)*sin(q5) + 2*Lc*Lp*Mp*q2_d*q3_d*cos(q1)*sin(q1)*sin(q2)*sin(q5) + 2*Lcp*Lp*Mp*q2_d*q3_d*cos(q1)*sin(q1)*sin(q2)*sin(q5) - 4*Lc*Lp*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)*sin(q1) - 4*Lc*Lp*Mp*q2_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)*sin(q2) - 4*Lcp*Lp*Mp*q1_d*q3_d*cos(q1)*cos(q2)^2*cos(q5)*sin(q1) - 4*Lcp*Lp*Mp*q2_d*q3_d*cos(q1)^2*cos(q2)*cos(q5)*sin(q2);    
            Tw - Iwy*q1_d*q3_d*cos(q1) + Lc*Mc*Rw*q2_d^2*sin(q2) + Lc*Mc*Rw*q3_d^2*sin(q2) + Lc*Mp*Rw*q2_d^2*sin(q2) + Lc*Mp*Rw*q3_d^2*sin(q2) + Lcp*Mp*Rw*q2_d^2*sin(q2) + Lcp*Mp*Rw*q3_d^2*sin(q2) - 2*Mc*Rw^2*q1_d*q3_d*cos(q1) - 2*Mp*Rw^2*q1_d*q3_d*cos(q1) - 2*Mw*Rw^2*q1_d*q3_d*cos(q1) + Lp*Mp*Rw*q2_d^2*cos(q5)*sin(q2) + Lp*Mp*Rw*q3_d^2*cos(q5)*sin(q2) + Lp*Mp*Rw*q5_d^2*cos(q5)*sin(q2) - 2*Lc*Mc*Rw*q1_d*q3_d*cos(q1)*cos(q2) - 2*Lc*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2) - 2*Lcp*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2) - 2*Lp*Mp*Rw*q3_d*q5_d*cos(q1)*cos(q5) + 2*Lp*Mp*Rw*q2_d*q5_d*cos(q2)*sin(q5) + 2*Lc*Mc*Rw*q2_d*q3_d*sin(q1)*sin(q2) + 2*Lc*Mp*Rw*q2_d*q3_d*sin(q1)*sin(q2) + 2*Lcp*Mp*Rw*q2_d*q3_d*sin(q1)*sin(q2) + 2*Lp*Mp*Rw*q1_d*q3_d*sin(q1)*sin(q5) - 2*Lp*Mp*Rw*q1_d*q3_d*cos(q1)*cos(q2)*cos(q5) + 2*Lp*Mp*Rw*q2_d*q3_d*cos(q5)*sin(q1)*sin(q2) + 2*Lp*Mp*Rw*q3_d*q5_d*cos(q2)*sin(q1)*sin(q5);        
            Tp + (Ipy*q1_d^2*sin(2*q5))/2 - (Ipy*q2_d^2*sin(2*q5))/2 - (Ipy*q3_d^2*sin(2*q5))/2 - (Ipz*q1_d^2*sin(2*q5))/2 + (Ipz*q2_d^2*sin(2*q5))/2 + (Ipz*q3_d^2*sin(2*q5))/2 + (Lp^2*Mp*q1_d^2*sin(2*q5))/2 - (Lp^2*Mp*q2_d^2*sin(2*q5))/2 - (Lp^2*Mp*q3_d^2*sin(2*q5))/2 + Ipx*q1_d*q2_d*sin(q2) - Ipy*q1_d*q2_d*sin(q2) + Ipz*q1_d*q2_d*sin(q2) - Ipy*q3_d^2*cos(q1)*cos(q2)*sin(q1) + Ipz*q3_d^2*cos(q1)*cos(q2)*sin(q1) + Lp*Mp*g*cos(q5)*sin(q1) + Ipx*q2_d*q3_d*cos(q1)*cos(q2) - Ipy*q2_d*q3_d*cos(q1)*cos(q2) + Ipz*q2_d*q3_d*cos(q1)*cos(q2) - Ipx*q1_d*q3_d*sin(q1)*sin(q2) - Ipy*q1_d*q3_d*sin(q1)*sin(q2) + Ipz*q1_d*q3_d*sin(q1)*sin(q2) - Ipy*q1_d^2*cos(q2)^2*cos(q5)*sin(q5) + Ipy*q3_d^2*cos(q1)^2*cos(q5)*sin(q5) + Ipz*q1_d^2*cos(q2)^2*cos(q5)*sin(q5) - Ipz*q3_d^2*cos(q1)^2*cos(q5)*sin(q5) + 2*Ipy*q1_d*q2_d*cos(q5)^2*sin(q2) - 2*Ipz*q1_d*q2_d*cos(q5)^2*sin(q2) - Lc*Lp*Mp*q2_d^2*sin(q5) - Lc*Lp*Mp*q3_d^2*sin(q5) - Lcp*Lp*Mp*q2_d^2*sin(q5) - Lcp*Lp*Mp*q3_d^2*sin(q5) - 2*Lp^2*Mp*q1_d*q3_d*sin(q1)*sin(q2) - Lp^2*Mp*q1_d^2*cos(q2)^2*cos(q5)*sin(q5) + Lp^2*Mp*q3_d^2*cos(q1)^2*cos(q5)*sin(q5) - 2*Ipy*q2_d*q3_d*cos(q5)*sin(q1)*sin(q5) + 2*Ipz*q2_d*q3_d*cos(q5)*sin(q1)*sin(q5) - Lc*Lp*Mp*q1_d^2*cos(q2)^2*sin(q5) - Lcp*Lp*Mp*q1_d^2*cos(q2)^2*sin(q5) + 2*Ipy*q3_d^2*cos(q1)*cos(q2)*cos(q5)^2*sin(q1) - 2*Ipz*q3_d^2*cos(q1)*cos(q2)*cos(q5)^2*sin(q1) + 2*Lp^2*Mp*q1_d*q2_d*cos(q5)^2*sin(q2) + 2*Ipy*q2_d*q3_d*cos(q1)*cos(q2)*cos(q5)^2 - 2*Ipz*q2_d*q3_d*cos(q1)*cos(q2)*cos(q5)^2 + 2*Ipy*q1_d*q3_d*cos(q5)^2*sin(q1)*sin(q2) - 2*Ipz*q1_d*q3_d*cos(q5)^2*sin(q1)*sin(q2) + Ipy*q3_d^2*cos(q1)^2*cos(q2)^2*cos(q5)*sin(q5) - Ipz*q3_d^2*cos(q1)^2*cos(q2)^2*cos(q5)*sin(q5) - Lp^2*Mp*q3_d^2*cos(q1)*cos(q2)*sin(q1) - Lp*Mp*Rw*q1_d^2*cos(q2)*sin(q5) - Lp*Mp*Rw*q3_d^2*cos(q2)*sin(q5) + Lp*Mp*g*cos(q1)*cos(q2)*sin(q5) + Lp*Mp*Rw*q3_d^2*cos(q1)^2*cos(q2)*sin(q5) + 2*Lp^2*Mp*q2_d*q3_d*cos(q1)*cos(q2)*cos(q5)^2 + 2*Lp^2*Mp*q1_d*q3_d*cos(q5)^2*sin(q1)*sin(q2) + Lp^2*Mp*q3_d^2*cos(q1)^2*cos(q2)^2*cos(q5)*sin(q5) + Lc*Lp*Mp*q3_d^2*cos(q1)^2*cos(q2)^2*sin(q5) + Lcp*Lp*Mp*q3_d^2*cos(q1)^2*cos(q2)^2*sin(q5) + Lp*Mp*Rw*q3_d^2*cos(q1)*cos(q5)*sin(q1) + Lp*Mp*Rw*q3_d*q4_d*cos(q1)*cos(q5) - 2*Lp^2*Mp*q2_d*q3_d*cos(q5)*sin(q1)*sin(q5) + 2*Lc*Lp*Mp*q1_d*q2_d*cos(q5)*sin(q2) + 2*Lcp*Lp*Mp*q1_d*q2_d*cos(q5)*sin(q2) + 2*Lp^2*Mp*q3_d^2*cos(q1)*cos(q2)*cos(q5)^2*sin(q1) - 2*Lc*Lp*Mp*q2_d*q3_d*sin(q1)*sin(q5) - 2*Lcp*Lp*Mp*q2_d*q3_d*sin(q1)*sin(q5) + Lc*Lp*Mp*q3_d^2*cos(q1)*cos(q2)*cos(q5)*sin(q1) + Lcp*Lp*Mp*q3_d^2*cos(q1)*cos(q2)*cos(q5)*sin(q1) + 2*Lc*Lp*Mp*q2_d*q3_d*cos(q1)*cos(q2)*cos(q5) + 2*Lcp*Lp*Mp*q2_d*q3_d*cos(q1)*cos(q2)*cos(q5) + 2*Lp*Mp*Rw*q1_d*q3_d*cos(q1)*sin(q2)*sin(q5) - Lp*Mp*Rw*q3_d*q4_d*cos(q2)*sin(q1)*sin(q5) + 2*Ipy*q1_d*q3_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) - 2*Ipz*q1_d*q3_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 2*Lp^2*Mp*q1_d*q3_d*cos(q1)*cos(q2)*cos(q5)*sin(q2)*sin(q5) + 2*Lc*Lp*Mp*q1_d*q3_d*cos(q1)*cos(q2)*sin(q2)*sin(q5) + 2*Lcp*Lp*Mp*q1_d*q3_d*cos(q1)*cos(q2)*sin(q2)*sin(q5)];

q_dd =  double(M) \ double(RHS);

q1_dd = double(q_dd(1));
q2_dd = double(q_dd(2));
q3_dd = double(q_dd(3));
q4_dd = double(q_dd(4));
q5_dd = double(q_dd(5));
%}
q1_dd = (257018694497473967612259568296394752000000*Tp + 175119453842495251304879817896265473064960*sin(q1) + 100045399726821169730336211043614720000000*cos(q2)*sin(q1) + (155684302471031865215430560338312701865157*q3_d^2*sin(2*q1))/318 - 78712068651194851382919469072418561064960*cos(q2)^2*sin(q1) - 137350947088034500259593846784000000000000*Tp*cos(q2) - 257018694497473967612259568296394752000000*Tp*cos(q2)^2 + (136576515031905385152002308795579170214850*q2_d*q3_d*cos(q1))/159 + (63905402526202618412714746698176105576144*q3_d*q4_d*cos(q1))/53 + 653341521412578816853108385752421498880*q1_d*q2_d*sin(q2) - 129280403332229399260100126834688000000*q1_d*q4_d*sin(q2) + (13761615997806169797484633704230161250000*q2_d*q5_d*sin(q2))/53 + (82055505425084746190005189647205676845700*q1_d*q2_d*sin(2*q2))/159 - (5049988549693129118858431815829924375000*q1_d*q4_d*sin(2*q2))/53 + 64640201666114699630050063417344000000*q2_d*q5_d*sin(2*q2) - 129280403332229399260100126834688000000*q1_d*q2_d*sin(q2)^3 + 524061118080349417593008258917733498880*q1_d*q3_d*sin(q1)*sin(q2) + (13761615997806169797484633704230161250000*q3_d*q5_d*sin(q1)*sin(q2))/53 + (66195727612803886616517039584623324862968*q3_d^2*cos(q1)*cos(q2)^2*sin(q1))/159 + 129280403332229399260100126834688000000*q3_d^2*cos(q1)*cos(q2)^3*sin(q1) + (164111010850169492380010379294411353691400*q2_d*q3_d*cos(q1)*cos(q2)^2)/159 + 129280403332229399260100126834688000000*q2_d*q3_d*cos(q1)*cos(q2)^3 - (32638427745788535254497779903262676276144*q3_d*q4_d*cos(q1)*cos(q2)^2)/53 - 129280403332229399260100126834688000000*q1_d*q3_d*sin(q1)*sin(q2)^3 + 951740225724146135033033244278784000000*q3_d^2*cos(q1)*cos(q2)*sin(q1) + 951740225724146135033033244278784000000*q2_d*q3_d*cos(q1)*cos(q2) + 540510314528187767146566685556736000000*q3_d*q4_d*cos(q1)*cos(q2) + (133811079552010717666859788399431807441400*q1_d*q3_d*cos(q2)*sin(q1)*sin(q2))/159 + 129280403332229399260100126834688000000*q3_d*q5_d*cos(q2)*sin(q1)*sin(q2))/(1081020629056375534293133371113472000000*cos(q2) - 425253785781175038052470118332128821248*cos(q2)^2 + 2031696727828117742266706462475676843123);
q2_dd = -(2408176241104907266220722025255476718539831253066161905310221170577385004728320*sin(2*q2) - 3351569542259007544496527825682468202435351306274893439647204167909376000000000*sin(q2) + 36187234782547618276738773518930011358353711269327965861549369130758894768432*q1_d*q3_d + 7910603826835353401381135725097003180690912170110305198367359518113792000000*q3_d*q5_d - 2770158898689973738234924095967497289025040176742245195053823315914260480000000*sin(q2)^3 - 5243170655798703121765729830397031672383536462991188152189848281487227846918144*cos(q1)^2*sin(q2) - 2179459905240879077648612473360534474888226786189742336840093134329846840688640*cos(q2)^3*sin(q2) + (171629842515161164412688213116577901066091712100401355939002163556625730764800000*Tw*cos(q1))/11 + 56223476502855645871447883057951658574323386488303901293917535588354715811840*q1_d*q3_d*cos(q2) + (1246082576407860059564080440979863772529582938760302158469339130420640738350000*q3_d*q5_d*cos(q2))/53 - 200599420511196627320732942604176441488014783203462535419069443225643359207482*q1_d*q2_d*sin(q1) - 11850377015378548761123311558977597848237188256202360956825415666274000700000*q1_d*q4_d*sin(q1) + 7910603826835353401381135725097003180690912170110305198367359518113792000000*q2_d*q5_d*sin(q1) - (146667679974767034661123494254657066144435803373557409205177882295743006375936*q3_d^2*cos(q1)^3*sin(q2))/5 - 10863362452965543206489377731861828555436500025621563485121336100204072025456640*cos(q1)^2*cos(q2)*sin(q2) + (248569024032710704173465386597484457459259849704165123254015641493216165888000000*Tw*cos(q1)*cos(q2))/11 - 10224320423890509078807378301633929716885158484267175809412859403675065868724*q1_d*q3_d*cos(q1)^2 + (6796228756673088483090011990734960284316120204640355013332761018513891707757512*q1_d*q3_d*cos(q2)^2)/159 - 17531224449612726554081576850975499501916142732371582214143822450787184803840*q1_d*q3_d*cos(q2)^3 - 26751977968019212309849841178099826524190785481182658227478477396232267366400*q1_d*q3_d*cos(q2)^4 - 3579647447007939456053304140778617120185645426157321359637020139323392000000*q1_d*q3_d*cos(q2)^5 - 7910603826835353401381135725097003180690912170110305198367359518113792000000*q3_d*q5_d*cos(q1)^2 + 4330956379827413945327831584318386060505266743952983838730339378790400000000*q3_d*q5_d*cos(q2)^2 - 10639018760043239665059594558022167742620400811981245292840969225581363200000*q3_d*q5_d*cos(q2)^3 - 3579647447007939456053304140778617120185645426157321359637020139323392000000*q3_d*q5_d*cos(q2)^4 + 12898474726908016770374735956247073030047202937040483630353784858067599360000000*Tp*sin(q1)*sin(q2) - 391375540073529620154110570239845973726038159058838724621362810845729029881856*cos(q1)^2*cos(q2)^2*sin(q2) + 2179459905240879077648612473360534474888226786189742336840093134329846840688640*cos(q1)^2*cos(q2)^3*sin(q2) + (47744696473945759933386712971757364182445400925753523157400779654320829235200000*Tw*cos(q1)*cos(q2)^2)/11 - (32913654324625349456693660638963030541597414372178688969533629846035365888000000*Tw*cos(q1)*cos(q2)^3)/11 + 10660922917979755301699038680651687446933352985083907338913970415765081292800000*Tp*sin(q1)*sin(q2)^3 + (307002880798994532843196041212278720531971550019592925435890120061914275905536*q1_d^2*cos(q1)*sin(q2))/5 + (146667679974767034661123494254657066144435803373557409205177882295743006375936*q3_d^2*cos(q1)*sin(q2))/5 + (197405464026304925744991843097702881730065450910662044655384385709319823294464*q1_d^2*cos(q1)*cos(q2)^2*sin(q2))/5 - 20586779239048190775281683490129808103164738609737884285417053123271012122624*q1_d^2*cos(q1)*cos(q2)^3*sin(q2) + 29932399924682692788267273615958686303430607414340264085189120436994048000000*q2_d^2*cos(q1)*cos(q2)^2*sin(q2) - 11774859834634718768132157093589024176256474991646925978850656077419152146432*q2_d^2*cos(q1)*cos(q2)^3*sin(q2) + (118403995992233759602729845994873768784876400876988110486334352286658345304064*q3_d^2*cos(q1)*cos(q2)^2*sin(q2))/5 + 14977118133384493541717684084510802347934310489535732248627821318813115219968*q3_d^2*cos(q1)*cos(q2)^3*sin(q2) - (11433169701730798133505905620748352754401813634729722478113244995526269964378991*q3_d^2*cos(q1)^3*cos(q2)*sin(q2))/159 + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q3_d^2*cos(q1)*cos(q2)^4*sin(q2) - (387405013781390280286107098073849159973513441262205857233127323249800369930240*q1_d*q3_d*cos(q1)^2*cos(q2))/11 - (9131428368874779401364708938728598764280545859672785608863548952353914100750000*q3_d*q5_d*cos(q1)^2*cos(q2))/583 + 15726846574225355459212878329856818188871106005707109880719464300353159168000000*Tp*cos(q2)*sin(q1)*sin(q2) + (33961646388787833549792848371498841881875004791845638645847939759048640937649464*q1_d*q2_d*cos(q2)^2*sin(q1))/159 + 35174280505736780110346362099384638864573781243994303236960378144554127196160*q1_d*q2_d*cos(q2)^3*sin(q1) - 55578272169588072861912780639802262989202969647584479290095749342031211659264*q1_d*q2_d*cos(q2)^4*sin(q1) - (333803050522374692813713556328668766176590129851293389797566600073220371650000*q1_d*q4_d*cos(q2)^2*sin(q1))/53 - 3579647447007939456053304140778617120185645426157321359637020139323392000000*q1_d*q2_d*cos(q2)^5*sin(q1) + 7159294894015878912106608281557234240371290852314642719274040278646784000000*q1_d*q4_d*cos(q2)^3*sin(q1) + 5276574532299423015798625274524388112499234183107969104915959790960640000000*q1_d*q4_d*cos(q2)^4*sin(q1) + 4330956379827413945327831584318386060505266743952983838730339378790400000000*q2_d*q5_d*cos(q2)^2*sin(q1) - 10639018760043239665059594558022167742620400811981245292840969225581363200000*q2_d*q5_d*cos(q2)^3*sin(q1) - 3579647447007939456053304140778617120185645426157321359637020139323392000000*q2_d*q5_d*cos(q2)^4*sin(q1) - (230406134200768207266876206264345665333592640881708540593918093389311785304064*q3_d^2*cos(q1)^3*cos(q2)^2*sin(q2))/5 - 6165198728971021534568157687970018421026046871444773942061424272961255243776*q3_d^2*cos(q1)^3*cos(q2)^3*sin(q2) - 3579647447007939456053304140778617120185645426157321359637020139323392000000*q3_d^2*cos(q1)^3*cos(q2)^4*sin(q2) + (6335815035111689124074656506074474191869116342157538099061454134980733040749222*q1_d*q3_d*cos(q1)^2*cos(q2)^2)/159 + (669097308938005011866262248185013113664979243423643359272848555558708696842240*q1_d*q3_d*cos(q1)^2*cos(q2)^3)/11 + 9128139159192268295550788385018258670374258245000741614345683304528547414016*q1_d*q3_d*cos(q1)^2*cos(q2)^4 + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q1_d*q3_d*cos(q1)^2*cos(q2)^5 - 155122587894999249514325227296521094561016728220965863384479589990400000000*q3_d*q5_d*cos(q1)^2*cos(q2)^2 + (98959541553074702548773674272614487910073402437620135440955819010555904000000*q3_d*q5_d*cos(q1)^2*cos(q2)^3)/11 + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q3_d*q5_d*cos(q1)^2*cos(q2)^4 - 7116595322083378995260605503488841389140507001933287004170890355113197568000000*Tp*cos(q2)^3*sin(q1)*sin(q2) + 131025482371852669196915607422073811317751963251497792213226518578812199238249*q1_d^2*cos(q1)*cos(q2)*sin(q2) + 56255687771753873202507753256922197044132536559602921697483181449640182546432*q2_d^2*cos(q1)*cos(q2)*sin(q2) + (4739283371890882183667425527423377035191235063576320098425959764822625537580088*q3_d^2*cos(q1)*cos(q2)*sin(q2))/159 - 60249549225857340693686665817011591352735461383466659619910214954480996188160*q1_d*q2_d*cos(q2)*sin(q1) - 15821207653670706802762271450194006361381824340220610396734719036227584000000*q1_d*q4_d*cos(q2)*sin(q1) + (86329810785126061393210866265092504406506914465859210081116631741002528700000*q1_d*q5_d*cos(q1)*sin(q2))/11 + (1246082576407860059564080440979863772529582938760302158469339130420640738350000*q2_d*q5_d*cos(q2)*sin(q1))/53 - (18069664807400933766881865865629357258751006494173562780294842470839091200000*q1_d*q5_d*cos(q1)*cos(q2)^2*sin(q2))/11 + 4175833791932414695813506357021864965944250015732017975345859788800000000000*q1_d*q5_d*cos(q1)*cos(q2)*sin(q2) + 26169472699510993646152765045957294086022274606678177210771427718183602094080*q2_d*q3_d*cos(q1)*sin(q1)*sin(q2) + (181188108205191683140230694431317166074875270605155487289523830678654115905536*q3_d*q4_d*cos(q1)*sin(q1)*sin(q2))/5 + 40112181406583288548697450390065860144321690834706884632532882112315832401920*q2_d*q3_d*cos(q1)*cos(q2)^2*sin(q1)*sin(q2) + 32028552500318635325648466452624214636690019664290627332394437187192907366400*q2_d*q3_d*cos(q1)*cos(q2)^3*sin(q1)*sin(q2) + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q2_d*q3_d*cos(q1)*cos(q2)^4*sin(q1)*sin(q2) - (7325911228975951170089221915558816178155534760695652463357257182435696705536*q3_d*q4_d*cos(q1)*cos(q2)^2*sin(q1)*sin(q2))/5 - 17051434366934141783930782368113412288755709174754895083766615868379792146432*q3_d*q4_d*cos(q1)*cos(q2)^3*sin(q1)*sin(q2) - (1639310836884324825944075384798894483800605351547102830585723297173157833663800*q2_d*q3_d*cos(q1)*cos(q2)*sin(q1)*sin(q2))/159 + (3728632893306376064626039530678197509837143314083816765750031764274605787846096*q3_d*q4_d*cos(q1)*cos(q2)*sin(q1)*sin(q2))/53)/(cos(q1)*(66147116691191846683948410162578628144220336105995585655281234789531648000000*cos(q2) - 82276756228137172919061936200559356286255076093243407116737355158223547531264*cos(q2)^2 - 29932399924682692788267273615958686303430607414340264085189120436994048000000*cos(q2)^3 + 11774859834634718768132157093589024176256474991646925978850656077419152146432*cos(q2)^4 + 124318516154561397179297513841042025347302841364496431118722114011338127337957));
q3_dd = (129280403332229399260100126834688000000*q2_d*q5_d - 3278330524393578246452870730137438564598*q1_d*q2_d - 193666824141793316744030398034307300000*q1_d*q4_d - 100045399726821169730336211043614720000000*sin(q1)*sin(q2) + 385023507240145778140498521687798579200000*Tp*sin(q2) + 128509347248736983806129784148197376000000*Tp*sin(2*q2) - 984638618619822834140150097556789002240*q1_d*q2_d*cos(q2) - 258560806664458798520200253669376000000*q1_d*q4_d*cos(q2) + (20364318778901304025150474727478135650000*q2_d*q5_d*cos(q2))/53 + 591396107120863921336511796779607821648*q1_d*q3_d*sin(q1) + 129280403332229399260100126834688000000*q3_d*q5_d*sin(q1) + (319149823071868557163693399993772242048264*q1_d*q2_d*cos(q2)^2)/159 + 129280403332229399260100126834688000000*q1_d*q2_d*cos(q2)^3 - (10099977099386258237716863631659848750000*q1_d*q4_d*cos(q2)^2)/53 + 129280403332229399260100126834688000000*q2_d*q5_d*cos(q2)^2 + 78712068651194851382919469072418561064960*cos(q2)*sin(q1)*sin(q2) + (153619187895296120349857311469175730641400*q1_d*q3_d*cos(q2)^2*sin(q1))/159 + 129280403332229399260100126834688000000*q1_d*q3_d*cos(q2)^3*sin(q1) + 129280403332229399260100126834688000000*q3_d*q5_d*cos(q2)^2*sin(q1) + 918841832828469435925916391000778997760*q1_d*q3_d*cos(q2)*sin(q1) + (20364318778901304025150474727478135650000*q3_d*q5_d*cos(q2)*sin(q1))/53)/(cos(q1)*(1081020629056375534293133371113472000000*cos(q2) - 425253785781175038052470118332128821248*cos(q2)^2 + 2031696727828117742266706462475676843123)) - (411229911195958367886466558722048000000*q3_d*q4_d*sin(q2) - 427679107643796717440024985361050501120*q2_d*q3_d*sin(q2) + 524061118080349417593008258917733498880*q3_d^2*sin(q1)*sin(q2) + 129280403332229399260100126834688000000*q3_d^2*cos(q2)^2*sin(q1)*sin(q2) + 129280403332229399260100126834688000000*q2_d*q3_d*cos(q2)^2*sin(q2) + (153619187895296120349857311469175730641400*q3_d^2*cos(q2)*sin(q1)*sin(q2))/159 + (319149823071868557163693399993772242048264*q2_d*q3_d*cos(q2)*sin(q2))/159 - (32638427745788535254497779903262676276144*q3_d*q4_d*cos(q2)*sin(q2))/53)/(1081020629056375534293133371113472000000*cos(q2) - 425253785781175038052470118332128821248*cos(q2)^2 + 2031696727828117742266706462475676843123);
q4_dd = (3351569542259007544496527825682468202435351306274893439647204167909376000000000*sin(q2) - 2408176241104907266220722025255476718539831253066161905310221170577385004728320*sin(2*q2) - 36187234782547618276738773518930011358353711269327965861549369130758894768432*q1_d*q3_d - 7910603826835353401381135725097003180690912170110305198367359518113792000000*q3_d*q5_d + 2770158898689973738234924095967497289025040176742245195053823315914260480000000*sin(q2)^3 - 6121728440948981282731451921649965491460391483017138634701027483823636480000000*cos(q1)^2*sin(q2) + 2179459905240879077648612473360534474888226786189742336840093134329846840688640*cos(q2)^3*sin(q2) + (955149653236912827464120334015344127347165218732257273304045536086421667840000000*Tw*cos(q1))/33 - 56223476502855645871447883057951658574323386488303901293917535588354715811840*q1_d*q3_d*cos(q2) - (1246082576407860059564080440979863772529582938760302158469339130420640738350000*q3_d*q5_d*cos(q2))/53 + 200599420511196627320732942604176441488014783203462535419069443225643359207482*q1_d*q2_d*sin(q1) + 11850377015378548761123311558977597848237188256202360956825415666274000700000*q1_d*q4_d*sin(q1) - 7910603826835353401381135725097003180690912170110305198367359518113792000000*q2_d*q5_d*sin(q1) - 32067040164845499636414509391524330877507149329207103246142447553234253905920*q3_d^2*cos(q1)^3*sin(q2) - 5596256895920477847117066505157098506372039072163990563951444640372969439232000*cos(q1)^2*cos(q2)*sin(q2) + (326653230122556440164961219526872203501481379637889567856602901670828965888000000*Tw*cos(q1)*cos(q2))/11 - (2176801014266271227484167451755327898051624625785362924148878953576412867497927*q1_d*q3_d*cos(q1)^2)/11 - (6796228756673088483090011990734960284316120204640355013332761018513891707757512*q1_d*q3_d*cos(q2)^2)/159 + 17531224449612726554081576850975499501916142732371582214143822450787184803840*q1_d*q3_d*cos(q2)^3 + 26751977968019212309849841178099826524190785481182658227478477396232267366400*q1_d*q3_d*cos(q2)^4 + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q1_d*q3_d*cos(q2)^5 + 7910603826835353401381135725097003180690912170110305198367359518113792000000*q3_d*q5_d*cos(q1)^2 - 4330956379827413945327831584318386060505266743952983838730339378790400000000*q3_d*q5_d*cos(q2)^2 + 10639018760043239665059594558022167742620400811981245292840969225581363200000*q3_d*q5_d*cos(q2)^3 + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q3_d*q5_d*cos(q2)^4 - 12898474726908016770374735956247073030047202937040483630353784858067599360000000*Tp*sin(q1)*sin(q2) - 2770158898689973738234924095967497289025040176742245195053823315914260480000000*cos(q1)^2*cos(q2)^2*sin(q2) + (17027794911752999759308395216717367548341133443010804198707085114574110720000000*Tw*cos(q1)*cos(q2)^2)/11 - (32913654324625349456693660638963030541597414372178688969533629846035365888000000*Tw*cos(q1)*cos(q2)^3)/11 - 10660922917979755301699038680651687446933352985083907338913970415765081292800000*Tp*sin(q1)*sin(q2)^3 + 113901596148501854675096349831329787186149452333821679841507430178305783889920*q2_d^2*cos(q1)*sin(q2) + 145968636313347354311510859222854118063656601663028783087649877731540037795840*q3_d^2*cos(q1)*sin(q2) + 120046571017038571288373049173858858006296654400051317380337540029910288957440*q1_d^2*cos(q1)*cos(q2)^2*sin(q2) + 36172885804198524548667955166941896028205806865257912563305932212465007853568*q1_d^2*cos(q1)*cos(q2)^3*sin(q2) - 23840706295003057124374695227178048063011566925103148883101660737255159889920*q2_d^2*cos(q1)*cos(q2)^2*sin(q2) - 18861768040805185667948413457470973844213600377906435326018983251840272957440*q1_d^2*cos(q1)*cos(q2)^4*sin(q2) - 508440405213020640484294244547918480286397504972183985619281836259504291840*q3_d^2*cos(q1)*cos(q2)^2*sin(q2) - 38526837802653931077981998271688850700447260472829584206329133473651419512832*q3_d^2*cos(q1)*cos(q2)^3*sin(q2) - (18344536351102642108002408727212012575137821835235291033689597308997658739385288*q3_d^2*cos(q1)^3*cos(q2)*sin(q2))/159 - 3579647447007939456053304140778617120185645426157321359637020139323392000000*q3_d^2*cos(q1)*cos(q2)^4*sin(q2) - 272340112540890420226336789230716304626215878597409140657482728081930605035520*q1_d*q3_d*cos(q1)^2*cos(q2) + (1246082576407860059564080440979863772529582938760302158469339130420640738350000*q3_d*q5_d*cos(q1)^2*cos(q2))/53 - 15726846574225355459212878329856818188871106005707109880719464300353159168000000*Tp*cos(q2)*sin(q1)*sin(q2) - (33961646388787833549792848371498841881875004791845638645847939759048640937649464*q1_d*q2_d*cos(q2)^2*sin(q1))/159 - 35174280505736780110346362099384638864573781243994303236960378144554127196160*q1_d*q2_d*cos(q2)^3*sin(q1) + 55578272169588072861912780639802262989202969647584479290095749342031211659264*q1_d*q2_d*cos(q2)^4*sin(q1) + (333803050522374692813713556328668766176590129851293389797566600073220371650000*q1_d*q4_d*cos(q2)^2*sin(q1))/53 + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q1_d*q2_d*cos(q2)^5*sin(q1) - 7159294894015878912106608281557234240371290852314642719274040278646784000000*q1_d*q4_d*cos(q2)^3*sin(q1) - 5276574532299423015798625274524388112499234183107969104915959790960640000000*q1_d*q4_d*cos(q2)^4*sin(q1) - 4330956379827413945327831584318386060505266743952983838730339378790400000000*q2_d*q5_d*cos(q2)^2*sin(q1) + 10639018760043239665059594558022167742620400811981245292840969225581363200000*q2_d*q5_d*cos(q2)^3*sin(q1) + 3579647447007939456053304140778617120185645426157321359637020139323392000000*q2_d*q5_d*cos(q2)^4*sin(q1) - 113446436982145914983996176540530301285591216405842018192630798493911896555520*q3_d^2*cos(q1)^3*cos(q2)^2*sin(q2) - 9420907836179312238818113988842069504015021384075254335827454816232740487168*q3_d^2*cos(q1)^3*cos(q2)^3*sin(q2) + 22441415487813125124001717598249590964399245804063756685656003391163664957440*q3_d^2*cos(q1)^3*cos(q2)^4*sin(q2) + (167375000368763100373832275574037334926464695875479146225654085734568982209694104*q1_d*q3_d*cos(q1)^2*cos(q2)^2)/1749 + 265264391920272658814987630181391238417902333370740636755651901598128825958400*q1_d*q3_d*cos(q1)^2*cos(q2)^3 + 45593793640377836787486069155783965532220828249333166899133387028697748340736*q1_d*q3_d*cos(q1)^2*cos(q2)^4 - 41303183528618310791950131055720564808612846181970192011674986643003937914880*q1_d*q3_d*cos(q1)^2*cos(q2)^5 + (126736567555298469707055253571140143168090456694796288191670273936719872000000*q3_d*q5_d*cos(q1)^2*cos(q2)^2)/11 - 6813087202425453318204023971436306932190402375556075901018661897581363200000*q3_d*q5_d*cos(q1)^2*cos(q2)^3 - (55931690042373883967465427909958513992491882340944472512109173784182784000000*q3_d*q5_d*cos(q1)^2*cos(q2)^4)/11 + 7116595322083378995260605503488841389140507001933287004170890355113197568000000*Tp*cos(q2)^3*sin(q1)*sin(q2) + 56255687771753873202507753256922197044132536559602921697483181449640182546432*q1_d^2*cos(q1)*cos(q2)*sin(q2) + 60604505304590693266507123028816333758522427005852071203216506623098880000000*q2_d^2*cos(q1)*cos(q2)*sin(q2) + (27980652694532562337377041288793809642742887729165770355001021862070380659385288*q3_d^2*cos(q1)*cos(q2)*sin(q2))/159 + 60249549225857340693686665817011591352735461383466659619910214954480996188160*q1_d*q2_d*cos(q2)*sin(q1) + 15821207653670706802762271450194006361381824340220610396734719036227584000000*q1_d*q4_d*cos(q2)*sin(q1) - (1246082576407860059564080440979863772529582938760302158469339130420640738350000*q2_d*q5_d*cos(q2)*sin(q1))/53 + 3825931557617786346855570586585860810429998436425169391822307328000000000000*q1_d*q5_d*cos(q1)*cos(q2)^2*sin(q2) - (16555568125286549950879082361393725670449782653213937556101952251625472000000*q1_d*q5_d*cos(q1)*cos(q2)^3*sin(q2))/11 + (79096047377196916308449106143637896502532522511313465965636540770025472000000*q1_d*q5_d*cos(q1)*cos(q2)*sin(q2))/11 + 201633719597492715704039934616702280286276630060965182472243432638427965685760*q2_d*q3_d*cos(q1)*sin(q1)*sin(q2) + 25162954518760569940593069356192310891419255882887487629273257876652032000000*q3_d*q4_d*cos(q1)*sin(q1)*sin(q2) - 27928794147224017220912293612504583663483609856232654228357962712838056181760*q2_d*q3_d*cos(q1)*cos(q2)^2*sin(q1)*sin(q2) - 55578272169588072861912780639802262989202969647584479290095749342031211659264*q2_d*q3_d*cos(q1)*cos(q2)^3*sin(q1)*sin(q2) - 3579647447007939456053304140778617120185645426157321359637020139323392000000*q2_d*q3_d*cos(q1)*cos(q2)^4*sin(q1)*sin(q2) + 18545847409349285850186940948757960271900949133327453402231580357820416000000*q3_d*q4_d*cos(q1)*cos(q2)^2*sin(q1)*sin(q2) + 5276574532299423015798625274524388112499234183107969104915959790960640000000*q3_d*q4_d*cos(q1)*cos(q2)^3*sin(q1)*sin(q2) + (38800852235161896963090806043663747279044883765361790573008224104304179723429176*q2_d*q3_d*cos(q1)*cos(q2)*sin(q1)*sin(q2))/159 + (984422229121843419530994298250055916933517881194432094988545310167892629514800*q3_d*q4_d*cos(q1)*cos(q2)*sin(q1)*sin(q2))/53)/(cos(q1)*(66147116691191846683948410162578628144220336105995585655281234789531648000000*cos(q2) - 82276756228137172919061936200559356286255076093243407116737355158223547531264*cos(q2)^2 - 29932399924682692788267273615958686303430607414340264085189120436994048000000*cos(q2)^3 + 11774859834634718768132157093589024176256474991646925978850656077419152146432*cos(q2)^4 + 124318516154561397179297513841042025347302841364496431118722114011338127337957));
q5_dd = -(100045399726821169730336211043614720000000*sin(q1) - (641417373658596790728612715629258085159434528013535936512*Tp)/144979879204311 + 96407385191300399921960348823846912000000*cos(q2)*sin(q1) + 262030559040174708796504129458866749440*q3_d^2*sin(2*q1) - (103860994180226390126876844133575548060565353005056000000*Tp*cos(q2))/48326626401437 + (52826198829574357174029726933684385958619790755709845504*Tp*cos(q2)^2)/48326626401437 - 427679107643796717440024985361050501120*q2_d*q3_d*cos(q1) + 411229911195958367886466558722048000000*q3_d*q4_d*cos(q1) + 696800713027773499573961299834388100227*q1_d*q2_d*sin(q2) + 193666824141793316744030398034307300000*q1_d*q4_d*sin(q2) - 129280403332229399260100126834688000000*q2_d*q5_d*sin(q2) + 213839553821898358720012492680525250560*q1_d*q2_d*sin(2*q2) + 64640201666114699630050063417344000000*q1_d*q4_d*sin(2*q2) - 62289648878255983279866424747622400000*q2_d*q5_d*sin(2*q2) + 549833083537687004612202967827373621248*q1_d*q2_d*sin(q2)^3 + 890467537169566816317991697868695400227*q1_d*q3_d*sin(q1)*sin(q2) - 129280403332229399260100126834688000000*q3_d*q5_d*sin(q1)*sin(q2) + 556959510976026116700125112195738501120*q3_d^2*cos(q1)*cos(q2)^2*sin(q1) - 549833083537687004612202967827373621248*q3_d^2*cos(q1)*cos(q2)^3*sin(q1) + 427679107643796717440024985361050501120*q2_d*q3_d*cos(q1)*cos(q2)^2 - 549833083537687004612202967827373621248*q2_d*q3_d*cos(q1)*cos(q2)^3 + 129280403332229399260100126834688000000*q3_d*q4_d*cos(q1)*cos(q2)^2 + 549833083537687004612202967827373621248*q1_d*q3_d*sin(q1)*sin(q2)^3 + 1945304970857408714247093533380430393123*q3_d^2*cos(q1)*cos(q2)*sin(q1) + 834506656472347303743958372677476693123*q2_d*q3_d*cos(q1)*cos(q2) + 589942920385171380343716354621008100000*q3_d*q4_d*cos(q1)*cos(q2) + 556959510976026116700125112195738501120*q1_d*q3_d*cos(q2)*sin(q1)*sin(q2) - 124579297756511966559732849495244800000*q3_d*q5_d*cos(q2)*sin(q1)*sin(q2))/(1081020629056375534293133371113472000000*cos(q2) - 425253785781175038052470118332128821248*cos(q2)^2 + 2031696727828117742266706462475676843123);

z1dot = q1_d;
z2dot = q1_dd;
z3dot = q2_d;
z4dot = q2_dd;
z5dot = q3_d;
z6dot = q3_dd;
z7dot = q4_d;
z8dot = q4_dd;
z9dot = q5_d;
z10dot= q5_dd;
z11dot = Rw*q4_d*cos(q3); % x_dot
z12dot = Rw*q4_d*sin(q3); % y_dot
z13dot = Rw*q4_dd*cos(q3) - Rw*q4_d*sin(q3)*q3_d; % x_ddot
z14dot = Rw*q4_dd*sin(q3) + Rw*q4_d*cos(q3)*q3_d; % y_ddot

dz = [z1dot; z2dot; z3dot; z4dot; z5dot; z6dot; z7dot; z8dot; z9dot; z10dot;z11dot;z12dot;z13dot;z14dot];
end